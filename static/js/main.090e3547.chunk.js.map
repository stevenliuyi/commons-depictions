{"version":3,"sources":["components/TopNavBar.js","components/Message.js","components/Image.js","utils/commons.js","utils/api.js","utils/gallery.js","components/ImageGallery.js","components/Home.js","components/App.js","index.js"],"names":["TopNavBar","react_default","a","createElement","Navbar_default","bg","sticky","Brand","className","react_router_dom","to","Collapse","style","justifyContent","Nav_default","Link","href","OverlayTrigger_default","placement","overlay","Tooltip_default","id","index_esm","size","Component","Message","this","props","icon","Spinner_default","animation","info","Image","state","titleWidth","imageWidth","_this$props","index","onClick","photo","margin","e","width","height","src","thumb_src","alt","title","backgroundImage","concat","tiny_src","backgroundSize","getThumbURL","filename","replace","substr","hash","md5","hash1","hash2","fetchDepictions","qid","fetch","then","res","json","images","query","search","map","p","encodeURIComponent","url","caption","totalhits","searchinfo","catch","err","console","log","lightboxTheme","arrow",":hover","opacity","backgroundColor","fill","transition","arrow__direction__left","marginLeft","arrow__direction__right","marginRight","arrow__size__medium","@media (min-width: 768px)","padding","borderRadius","marginTop","container","background","figure","boxShadow","close","footer","color","footerCaption","display","alignItems","footerCount","ImageGallery","status","loadingStatus","currentImage","lightboxIsOpen","fetchImages","_this","_ref","setState","length","handleImagesLoaded","new_images","forEach","img","i","imgElement","document","getElementById","naturalWidth","push","Object","objectSpread","naturalHeight","openLightbox","event","obj","closeLightbox","gotoPrevious","gotoNext","onClickImage","window","open","lightboxCaption","image","linkString","renderToString","_this2","match","params","toUpperCase","ok","validateQID","prevProps","prevState","_this3","_this$state","Container_default","components_Message","IoIosWarning","dist_index_esm","bounds","onResize","contentRect","_ref2","measureRef","ref","columns","parseInt","Row_default","react_photo_gallery_esm","photos","ImageComponent","Lightbox_default","onClose","onClickPrev","onClickNext","isOpen","theme","spinnerColor","backdropClosesModal","OnImagesLoaded_default","onLoaded","key","Home","target","rel","App","react_router","path","component","exact","WebFont","load","google","families","ReactDOM","render","src_components_App"],"mappings":"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","file":"static/js/main.090e3547.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger'\nimport Tooltip from 'react-bootstrap/Tooltip'\nimport { GoMarkGithub } from 'react-icons/go'\nimport { Link } from 'react-router-dom'\n\nclass TopNavBar extends Component {\n  render() {\n    return (\n      <Navbar bg=\"light\" sticky=\"top\">\n        <Navbar.Brand>\n          <span className=\"app-name\"><Link to=\"/\">Depicts</Link></span>\n        </Navbar.Brand>\n        <Navbar.Collapse style={{ justifyContent: 'flex-end' }}>\n          <Nav>\n            <Nav.Link href=\"https://github.com/stevenliuyi/commons-depicts\">\n              <OverlayTrigger\n                placement=\"bottom\"\n                overlay={\n                  <Tooltip id=\"source\">source code</Tooltip>\n                }\n              >\n                <GoMarkGithub size={18} />\n              </OverlayTrigger>\n            </Nav.Link>\n          </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n    )\n  }\n}\n\nexport default TopNavBar\n","import React, { Component } from 'react'\nimport Spinner from 'react-bootstrap/Spinner'\n\nclass Message extends Component {\n\n  render() {\n    return (\n        <div className=\"message\">\n          {\n            this.props.icon === 'spinner' ?\n              <Spinner animation=\"border\" size=\"md\" className=\"message-icon\" />\n              : <this.props.icon size={36} className=\"message-icon\" />\n          }\n          <div>{ this.props.info }</div>\n        </div>\n    )\n  }\n}\n\nexport default Message\n","import React, { Component } from 'react'\n\nclass Image extends Component {\n  state = {\n    titleWidth: -1,\n    imageWidth: -1\n  }\n\n  render() {\n    const { index, onClick, photo, margin } = this.props\n    return (\n      <div\n        style={{ margin: margin }}\n        onClick={e => onClick(e, { index, photo })}\n      >\n        <img\n          className=\"thumb-image\"\n          width={photo.width}\n          height={photo.height}\n          src={photo.thumb_src}\n          alt={photo.title}\n          style={{\n            backgroundImage: `url(${photo.tiny_src})`,\n            backgroundSize: 'cover'\n          }}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Image\n","import md5 from 'blueimp-md5'\n\nexport const getThumbURL = (title, width) => {\n  const filename = title.replace(/ /g, '_').substr(5)\n  const hash = md5(filename)\n  const hash1 = hash.substr(0, 1)\n  const hash2 = hash.substr(0, 2)\n  const thumb_src = `https://upload.wikimedia.org/wikipedia/commons/thumb/${hash1}/${hash2}/${filename}/${width}-${filename}`\n\n  return thumb_src\n}\n\nexport const getOriginalURL = title =>\n    `https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(title.substr(5))}`\n","import { getThumbURL, getOriginalURL } from './commons'\n\nexport const fetchSPARQLResult = sparql =>\n    fetch(`https://query.wikidata.org/sparql?query=${encodeURIComponent(sparql)}&format=json`)\n      .then(res => {\n         return res.status >= 400 ? null : res.json()\n      })\n      .catch(err => {\n         console.log(err)\n         return null\n      })\n\nexport const validateQID = (qid) =>\n    fetch(`https://www.wikidata.org/wiki/Special:EntityData/${qid}`)\n.then(res => res.ok)\n\nexport const fetchDepictions = qid =>\n    fetch(`https://commons.wikimedia.org/w/api.php?action=query&list=search&srsearch=haswbstatement:P180=${qid}&srnamespace=6&srlimit=100&format=json&origin=*`)\n    .then(res => res.json())\n    .then(res => ({ images: res.query.search.map(p => ({\n      thumb_src: getThumbURL(p.title, '300px'),\n      src: getOriginalURL(p.title),\n      tiny_src: getThumbURL(p.title, '10px'),\n      url: `https://commons.wikimedia.org/wiki/${p.title.replace(/ /g, '_')}`,\n      caption: p.title\n    })),\n      totalhits: res.query.searchinfo.totalhits })\n    )\n     .catch(err => {\n        console.log(err)\n        return null\n     })\n","export const lightboxTheme = {\n  arrow: {\n    ':hover': { opacity: 1 },\n    backgroundColor: 'rgba(255, 255, 255, .8)',\n    fill: '#222',\n    opacity: 0.6,\n    transition: 'opacity .2s'\n  },\n  arrow__direction__left: {\n    marginLeft: 10\n  },\n  arrow__direction__right: {\n    marginRight: 10\n  },\n  arrow__size__medium: {\n    '@media (min-width: 768px)': {\n      height: 70,\n      padding: 15\n    },\n    borderRadius: 40,\n    height: 40,\n    marginTop: -20\n  },\n  container: {\n    background: 'rgba(255, 255, 255, .9)'\n  },\n  figure: {\n    boxShadow: '0px 0px 50px rgba(0, 0, 0, .2)'\n  },\n  close: {\n    ':hover': { opacity: 1 },\n    fill: '#222',\n    opacity: 0.6\n  },\n  footer: {\n    color: '#222',\n    marginLeft: '5px',\n    marginRight: '5px'\n  },\n  footerCaption: {\n    display: 'inline-flex',\n    alignItems: 'center'\n  },\n  footerCount: {\n    color: '#222',\n    display: 'none'\n  }\n}\n","import React, { Component } from 'react'\nimport { renderToString } from 'react-dom/server'\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport OnImagesLoaded from 'react-on-images-loaded'\nimport Measure from 'react-measure'\nimport Gallery from 'react-photo-gallery'\nimport { IoIosWarning } from 'react-icons/io'\nimport Lightbox from 'react-images'\nimport Message from './Message'\nimport Image from './Image'\nimport { validateQID, fetchDepictions } from '../utils/api'\nimport { lightboxTheme } from '../utils/gallery'\n\nclass ImageGallery extends Component {\n\n  state = {\n    qid: null,\n    status: false,\n    images: [],\n    totalhits: 0,\n    width: -1,\n    loadingStatus: null, // loading or loaded\n    currentImage: 0,\n    lightboxIsOpen: false\n  }\n\n  fetchImages = () => {\n    if (this.state.qid == null) return\n    fetchDepictions(this.state.qid).then(({ images, totalhits }) => this.setState({\n        images,\n        totalhits,\n        loadingStatus: images.length > 0 ? 'loading' : 'loaded' }))\n  }\n\n  handleImagesLoaded = () => {\n    // obtain heights and widths of the images\n    let new_images = []\n    this.state.images.forEach((img, i) => {\n      const imgElement = document.getElementById(`img${i}`)      \n      if (imgElement.naturalWidth > 0)\n        new_images.push({\n          ...this.state.images[i],\n          width: imgElement.naturalWidth,\n          height: imgElement.naturalHeight\n        })\n    })\n    this.setState({ images: new_images, loadingStatus: 'loaded' })\n  }\n    \n  componentDidMount() {\n    const qid = this.props.match.params.qid.toUpperCase()\n    validateQID(qid).then(status => this.setState({ qid, status }))\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.qid !== this.state.qid) this.fetchImages()\n  }\n\n  openLightbox = (event, obj) => this.setState({ currentImage: obj.index, lightboxIsOpen: true })\n\n  closeLightbox = () => this.setState({ currentImage: 0, lightboxIsOpen: false })\n\n  gotoPrevious = () => this.setState({ currentImage: this.state.currentImage - 1 })\n\n  gotoNext = () => this.setState({ currentImage: this.state.currentImage + 1 })\n\n  onClickImage = e => {\n    window.open(this.state.images[this.state.currentImage].url, '_blank')\n  }\n\n  lightboxCaption = image => {\n      const linkString = renderToString(<a href={image.url}>a</a>)\n    return `<span>${image.title}${linkString}</span>`\n  }\n    \n  render() {\n    const { qid, status, images, totalhits, width, loadingStatus, currentImage, lightboxIsOpen } = this.state\n    if (qid == null) return <div />\n    return (\n          <Container>\n        {\n        !status  &&  <Message\n            icon={IoIosWarning}\n            info={`Wikidata item ${qid} cannot be found`} />\n        }\n        {\n        status && loadingStatus === 'loading' &&\n          <Message\n            icon=\"spinner\"\n            info={`Loading images depicting Wikidata item ${qid}`} />\n        }\n        {\n        status  && loadingStatus === 'loaded' && images.length > 0 &&\n          <Measure bounds onResize={contentRect => this.setState({ width: contentRect.bounds.width})}>\n          {({ measureRef }) => {\n            if (width < 1)  return <div ref={measureRef} />\n            let columns = 1\n            if (width >= 320) columns = 2\n            if (width >= 750) columns = 3\n            if (width >= 1200) columns = parseInt(width / 300, 10)\n            return (<div ref={measureRef}>\n              <Row><div className=\"depict-title\"><span>{`Depictions of ${qid} on Wikimedia Commons`}</span><span className=\"depict-hits\">{`${totalhits} images found${totalhits > 100 ? ', only the first 100 are shown' : ''}`}</span></div></Row>\n              <Gallery\n                photos={images}\n                ImageComponent={Image}\n                columns={columns}\n                margin={5}\n                onClick={this.openLightbox}\n              />\n              <Lightbox\n                images={images}\n                onClose={this.closeLightbox}\n                onClickPrev={this.gotoPrevious}\n                onClickNext={this.gotoNext}\n                onClickImage={this.onClickImage}\n                currentImage={currentImage}\n                isOpen={lightboxIsOpen}\n                theme={lightboxTheme}\n                spinnerColor={'#aaa'}\n                backdropClosesModal={true}\n                />\n            </div>)\n          }}\n          </Measure>\n        }\n        {\n          status && loadingStatus === 'loaded' && images.length === 0 &&\n            <Message icon={IoIosWarning} info={`Cannot find any depictions of ${qid} on Wikimedia Commons.`} />\n        }\n        {/* load tiny thumbs to obtain the heights and widths of the images for later display */}\n        {\n        status && loadingStatus === 'loading' && images.length > 0 &&\n        <OnImagesLoaded onLoaded={() => this.handleImagesLoaded()}>\n          {\n           images.map((img, i) => (\n              <img id={`img${i}`} className=\"tiny-images\" key={`img${i}`} src={img.tiny_src} alt=\"\" style={{ display: 'none '}} />\n            ))\n          }\n        </OnImagesLoaded>\n        }\n          </Container>\n    )\n  }\n}\n\nexport default ImageGallery\n","import React, { Component } from 'react'\nimport Container from 'react-bootstrap/Container'\nimport { Link } from 'react-router-dom'\n\nclass Home extends Component {\n\n  render() {\n\n    return (\n          <Container>\n            <div className=\"info\">\n            This tool is designed for displaying depictions of Wikidata items on Wikimedia Commons. For example, the link <Link to=\"/Q41994\">/Q41994</Link> shows all the images on Commons that depict <a href=\"https://www.wikidata.org/wiki/Q41994\" target=\"_blank\" rel=\"noopener noreferrer\">Q41994</a> (<i>Phoenicopterus</i>, or flamingos).\n            </div>\n          </Container>\n    )\n  }\n}\n\nexport default Home\n","import React, { Component } from 'react'\nimport './App.css'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom'\nimport TopNavBar from './TopNavBar'\nimport ImageGallery from './ImageGallery'\nimport Home from './Home'\n\nclass App extends Component {\n\n  render() {\n    return (\n      <div className=\"site\">\n        <div className=\"site-content\">\n            <Router>\n              <div>\n                <Route path=\"/\" component={TopNavBar} />\n               <Switch>\n                <Route exact path=\"/:qid([qQ]\\d+)\" component={ImageGallery} />\n                <Route path=\"/\" component={Home} />\n               </Switch>\n        </div>\n           </Router>\n        </div>\n        <footer className=\"footer\">\n          Steven Liu&nbsp;&nbsp;2019\n        </footer>\n      </div>\n    )\n  }\n}\n\nexport default App\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport WebFont from 'webfontloader'\n\nWebFont.load({\n    google: {\n        families: [\n            'Montserrat:700',\n            'san-serif'\n        ]\n    }\n})\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}