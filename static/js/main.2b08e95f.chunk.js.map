{"version":3,"sources":["components/TopNavBar.js","components/Message.js","components/Image.js","utils/commons.js","utils/api.js","utils/gallery.js","components/ImageGallery.js","components/Home.js","components/App.js","index.js"],"names":["TopNavBar","react_default","a","createElement","Navbar_default","bg","sticky","Brand","className","react_router_dom","to","Collapse","style","justifyContent","Nav_default","Link","href","OverlayTrigger_default","placement","overlay","Tooltip_default","id","index_esm","size","Component","Message","this","props","icon","Spinner_default","animation","info","Image","state","titleWidth","imageWidth","_this$props","index","onClick","photo","margin","e","width","height","src","thumb_src","alt","title","backgroundImage","concat","tiny_src","backgroundSize","getThumbURL","filename","replace","substr","hash","md5","hash1","hash2","fetchDepictions","qid","fetch","then","res","json","images","query","search","map","p","encodeURIComponent","url","caption","totalhits","searchinfo","catch","err","console","log","lightboxTheme","arrow",":hover","opacity","backgroundColor","fill","transition","arrow__direction__left","marginLeft","arrow__direction__right","marginRight","arrow__size__medium","@media (min-width: 768px)","padding","borderRadius","marginTop","container","background","figure","boxShadow","close","footer","color","footerCaption","display","alignItems","footerCount","ImageGallery","status","loadingStatus","currentImage","lightboxIsOpen","fetchImages","_this","_ref","setState","length","handleImagesLoaded","new_images","forEach","img","i","imgElement","document","getElementById","naturalWidth","push","Object","objectSpread","naturalHeight","openLightbox","event","obj","closeLightbox","gotoPrevious","gotoNext","onClickImage","window","open","lightboxCaption","image","linkString","renderToString","_this2","match","params","toUpperCase","ok","validateQID","prevProps","prevState","_this3","_this$state","Container_default","components_Message","IoIosWarning","dist_index_esm","bounds","onResize","contentRect","_ref2","measureRef","ref","columns","parseInt","Row_default","react_photo_gallery_esm","photos","ImageComponent","Lightbox_default","onClose","onClickPrev","onClickNext","isOpen","theme","spinnerColor","backdropClosesModal","OnImagesLoaded_default","onLoaded","key","Home","target","rel","App","basename","process","react_router","path","component","exact","WebFont","load","google","families","ReactDOM","render","src_components_App"],"mappings":"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","file":"static/js/main.2b08e95f.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger'\nimport Tooltip from 'react-bootstrap/Tooltip'\nimport { GoMarkGithub } from 'react-icons/go'\nimport { Link } from 'react-router-dom'\n\nclass TopNavBar extends Component {\n  render() {\n    return (\n      <Navbar bg=\"light\" sticky=\"top\">\n        <Navbar.Brand>\n          <span className=\"app-name\">\n            <Link to=\"/\">Depicts</Link>\n          </span>\n        </Navbar.Brand>\n        <Navbar.Collapse style={{ justifyContent: 'flex-end' }}>\n          <Nav>\n            <Nav.Link href=\"https://github.com/stevenliuyi/commons-depicts\">\n              <OverlayTrigger\n                placement=\"bottom\"\n                overlay={<Tooltip id=\"source\">source code</Tooltip>}\n              >\n                <GoMarkGithub size={18} />\n              </OverlayTrigger>\n            </Nav.Link>\n          </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n    )\n  }\n}\n\nexport default TopNavBar\n","import React, { Component } from 'react'\nimport Spinner from 'react-bootstrap/Spinner'\n\nclass Message extends Component {\n  render() {\n    return (\n      <div className=\"message\">\n        {this.props.icon === 'spinner' ? (\n          <Spinner animation=\"border\" size=\"md\" className=\"message-icon\" />\n        ) : (\n          <this.props.icon size={36} className=\"message-icon\" />\n        )}\n        <div>{this.props.info}</div>\n      </div>\n    )\n  }\n}\n\nexport default Message\n","import React, { Component } from 'react'\n\nclass Image extends Component {\n  state = {\n    titleWidth: -1,\n    imageWidth: -1\n  }\n\n  render() {\n    const { index, onClick, photo, margin } = this.props\n    return (\n      <div\n        style={{ margin: margin }}\n        onClick={e => onClick(e, { index, photo })}\n      >\n        <img\n          className=\"thumb-image\"\n          width={photo.width}\n          height={photo.height}\n          src={photo.thumb_src}\n          alt={photo.title}\n          style={{\n            backgroundImage: `url(${photo.tiny_src})`,\n            backgroundSize: 'cover'\n          }}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Image\n","import md5 from 'blueimp-md5'\n\nexport const getThumbURL = (title, width) => {\n  const filename = title.replace(/ /g, '_').substr(5)\n  const hash = md5(filename)\n  const hash1 = hash.substr(0, 1)\n  const hash2 = hash.substr(0, 2)\n  const thumb_src = `https://upload.wikimedia.org/wikipedia/commons/thumb/${hash1}/${hash2}/${filename}/${width}-${filename}`\n\n  return thumb_src\n}\n\nexport const getOriginalURL = title =>\n  `https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(\n    title.substr(5)\n  )}`\n","import { getThumbURL, getOriginalURL } from './commons'\n\nexport const fetchSPARQLResult = sparql =>\n  fetch(\n    `https://query.wikidata.org/sparql?query=${encodeURIComponent(\n      sparql\n    )}&format=json`\n  )\n    .then(res => {\n      return res.status >= 400 ? null : res.json()\n    })\n    .catch(err => {\n      console.log(err)\n      return null\n    })\n\nexport const validateQID = qid =>\n  fetch(`https://www.wikidata.org/wiki/Special:EntityData/${qid}`).then(\n    res => res.ok\n  )\n\nexport const fetchDepictions = qid =>\n  fetch(\n    `https://commons.wikimedia.org/w/api.php?action=query&list=search&srsearch=haswbstatement:P180=${qid}&srnamespace=6&srlimit=100&format=json&origin=*`\n  )\n    .then(res => res.json())\n    .then(res => ({\n      images: res.query.search.map(p => ({\n        thumb_src: getThumbURL(p.title, '300px'),\n        src: getOriginalURL(p.title),\n        tiny_src: getThumbURL(p.title, '10px'),\n        url: `https://commons.wikimedia.org/wiki/${p.title.replace(/ /g, '_')}`,\n        caption: p.title\n      })),\n      totalhits: res.query.searchinfo.totalhits\n    }))\n    .catch(err => {\n      console.log(err)\n      return null\n    })\n","export const lightboxTheme = {\n  arrow: {\n    ':hover': { opacity: 1 },\n    backgroundColor: 'rgba(255, 255, 255, .8)',\n    fill: '#222',\n    opacity: 0.6,\n    transition: 'opacity .2s'\n  },\n  arrow__direction__left: {\n    marginLeft: 10\n  },\n  arrow__direction__right: {\n    marginRight: 10\n  },\n  arrow__size__medium: {\n    '@media (min-width: 768px)': {\n      height: 70,\n      padding: 15\n    },\n    borderRadius: 40,\n    height: 40,\n    marginTop: -20\n  },\n  container: {\n    background: 'rgba(255, 255, 255, .9)'\n  },\n  figure: {\n    boxShadow: '0px 0px 50px rgba(0, 0, 0, .2)'\n  },\n  close: {\n    ':hover': { opacity: 1 },\n    fill: '#222',\n    opacity: 0.6\n  },\n  footer: {\n    color: '#222',\n    marginLeft: '5px',\n    marginRight: '5px'\n  },\n  footerCaption: {\n    display: 'inline-flex',\n    alignItems: 'center'\n  },\n  footerCount: {\n    color: '#222',\n    display: 'none'\n  }\n}\n","import React, { Component } from 'react'\nimport { renderToString } from 'react-dom/server'\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport OnImagesLoaded from 'react-on-images-loaded'\nimport Measure from 'react-measure'\nimport Gallery from 'react-photo-gallery'\nimport { IoIosWarning } from 'react-icons/io'\nimport Lightbox from 'react-images'\nimport Message from './Message'\nimport Image from './Image'\nimport { validateQID, fetchDepictions } from '../utils/api'\nimport { lightboxTheme } from '../utils/gallery'\n\nclass ImageGallery extends Component {\n  state = {\n    qid: null,\n    status: false,\n    images: [],\n    totalhits: 0,\n    width: -1,\n    loadingStatus: null, // loading or loaded\n    currentImage: 0,\n    lightboxIsOpen: false\n  }\n\n  fetchImages = () => {\n    if (this.state.qid == null) return\n    fetchDepictions(this.state.qid).then(({ images, totalhits }) =>\n      this.setState({\n        images,\n        totalhits,\n        loadingStatus: images.length > 0 ? 'loading' : 'loaded'\n      })\n    )\n  }\n\n  handleImagesLoaded = () => {\n    // obtain heights and widths of the images\n    let new_images = []\n    this.state.images.forEach((img, i) => {\n      const imgElement = document.getElementById(`img${i}`)\n      if (imgElement.naturalWidth > 0)\n        new_images.push({\n          ...this.state.images[i],\n          width: imgElement.naturalWidth,\n          height: imgElement.naturalHeight\n        })\n    })\n    this.setState({ images: new_images, loadingStatus: 'loaded' })\n  }\n\n  componentDidMount() {\n    const qid = this.props.match.params.qid.toUpperCase()\n    validateQID(qid).then(status => this.setState({ qid, status }))\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.qid !== this.state.qid) this.fetchImages()\n  }\n\n  openLightbox = (event, obj) =>\n    this.setState({ currentImage: obj.index, lightboxIsOpen: true })\n\n  closeLightbox = () =>\n    this.setState({ currentImage: 0, lightboxIsOpen: false })\n\n  gotoPrevious = () =>\n    this.setState({ currentImage: this.state.currentImage - 1 })\n\n  gotoNext = () => this.setState({ currentImage: this.state.currentImage + 1 })\n\n  onClickImage = e => {\n    window.open(this.state.images[this.state.currentImage].url, '_blank')\n  }\n\n  lightboxCaption = image => {\n    const linkString = renderToString(<a href={image.url}>a</a>)\n    return `<span>${image.title}${linkString}</span>`\n  }\n\n  render() {\n    const {\n      qid,\n      status,\n      images,\n      totalhits,\n      width,\n      loadingStatus,\n      currentImage,\n      lightboxIsOpen\n    } = this.state\n    if (qid == null) return <div />\n    return (\n      <Container>\n        {!status && (\n          <Message\n            icon={IoIosWarning}\n            info={`Wikidata item ${qid} cannot be found`}\n          />\n        )}\n        {status && loadingStatus === 'loading' && (\n          <Message\n            icon=\"spinner\"\n            info={`Loading images depicting Wikidata item ${qid}`}\n          />\n        )}\n        {status && loadingStatus === 'loaded' && images.length > 0 && (\n          <Measure\n            bounds\n            onResize={contentRect =>\n              this.setState({ width: contentRect.bounds.width })\n            }\n          >\n            {({ measureRef }) => {\n              if (width < 1) return <div ref={measureRef} />\n              let columns = 1\n              if (width >= 320) columns = 2\n              if (width >= 750) columns = 3\n              if (width >= 1200) columns = parseInt(width / 300, 10)\n              return (\n                <div ref={measureRef}>\n                  <Row>\n                    <div className=\"depict-title\">\n                      <span>{`Depictions of ${qid} on Wikimedia Commons`}</span>\n                      <span className=\"depict-hits\">{`${totalhits} images found${\n                        totalhits > 100 ? ', only the first 100 are shown' : ''\n                      }`}</span>\n                    </div>\n                  </Row>\n                  <Gallery\n                    photos={images}\n                    ImageComponent={Image}\n                    columns={columns}\n                    margin={5}\n                    onClick={this.openLightbox}\n                  />\n                  <Lightbox\n                    images={images}\n                    onClose={this.closeLightbox}\n                    onClickPrev={this.gotoPrevious}\n                    onClickNext={this.gotoNext}\n                    onClickImage={this.onClickImage}\n                    currentImage={currentImage}\n                    isOpen={lightboxIsOpen}\n                    theme={lightboxTheme}\n                    spinnerColor={'#aaa'}\n                    backdropClosesModal={true}\n                  />\n                </div>\n              )\n            }}\n          </Measure>\n        )}\n        {status && loadingStatus === 'loaded' && images.length === 0 && (\n          <Message\n            icon={IoIosWarning}\n            info={`Cannot find any depictions of ${qid} on Wikimedia Commons.`}\n          />\n        )}\n        {/* load tiny thumbs to obtain the heights and widths of the images for later display */}\n        {status && loadingStatus === 'loading' && images.length > 0 && (\n          <OnImagesLoaded onLoaded={() => this.handleImagesLoaded()}>\n            {images.map((img, i) => (\n              <img\n                id={`img${i}`}\n                className=\"tiny-images\"\n                key={`img${i}`}\n                src={img.tiny_src}\n                alt=\"\"\n                style={{ display: 'none ' }}\n              />\n            ))}\n          </OnImagesLoaded>\n        )}\n      </Container>\n    )\n  }\n}\n\nexport default ImageGallery\n","import React, { Component } from 'react'\nimport Container from 'react-bootstrap/Container'\nimport { Link } from 'react-router-dom'\n\nclass Home extends Component {\n  render() {\n    return (\n      <Container>\n        <div className=\"info\">\n          This tool is designed for displaying depictions of Wikidata items on\n          Wikimedia Commons. For example, the link{' '}\n          <Link to=\"/Q41994\">/Q41994</Link> shows all the images on Commons that\n          depict{' '}\n          <a\n            href=\"https://www.wikidata.org/wiki/Q41994\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Q41994\n          </a>{' '}\n          (<i>Phoenicopterus</i>, or flamingos).\n        </div>\n      </Container>\n    )\n  }\n}\n\nexport default Home\n","import React, { Component } from 'react'\nimport './App.css'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom'\nimport TopNavBar from './TopNavBar'\nimport ImageGallery from './ImageGallery'\nimport Home from './Home'\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"site\">\n        <div className=\"site-content\">\n          <Router basename={process.env.PUBLIC_URL}>\n            <div>\n              <Route path=\"/\" component={TopNavBar} />\n              <Switch>\n                <Route exact path=\"/:qid([qQ]\\d+)\" component={ImageGallery} />\n                <Route path=\"/\" component={Home} />\n              </Switch>\n            </div>\n          </Router>\n        </div>\n        <footer className=\"footer\">Steven Liu&nbsp;&nbsp;2019</footer>\n      </div>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './components/App'\nimport WebFont from 'webfontloader'\n\nWebFont.load({\n  google: {\n    families: ['Montserrat:700', 'san-serif']\n  }\n})\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}