(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{185:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),o=n(12),r=n.n(o),c=(n(98),n(16)),l=n(17),s=n(19),u=n(18),m=n(20),h=(n(99),n(100),n(28)),d=n(23),p=n(34),g=n.n(p),f=n(47),b=n.n(f),w=n(79),E=n.n(w),y=n(81),k=n.n(y),v=n(82),j=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(g.a,{bg:"light",sticky:"top"},i.a.createElement(g.a.Brand,null,i.a.createElement("span",{className:"app-name"},i.a.createElement(h.b,{to:"/"},"Depicts"))),i.a.createElement(g.a.Collapse,{style:{justifyContent:"flex-end"}},i.a.createElement(b.a,null,i.a.createElement(b.a.Link,{href:"https://github.com/stevenliuyi/commons-depicts"},i.a.createElement(E.a,{placement:"bottom",overlay:i.a.createElement(k.a,{id:"source"},"source code")},i.a.createElement(v.a,{size:18}))))))}}]),t}(a.Component),O=n(92),I=n(83),x=n(33),C=n.n(x),_=n(90),S=n.n(_),N=n(84),q=n.n(N),L=n(85),W=n(86),Q=n(49),D=n(87),P=n.n(D),z=n(88),R=n.n(z),M=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"message"},"spinner"===this.props.icon?i.a.createElement(R.a,{animation:"border",size:"md",className:"message-icon"}):i.a.createElement(this.props.icon,{size:36,className:"message-icon"}),i.a.createElement("div",null,this.props.info))}}]),t}(a.Component),U=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={titleWidth:-1,imageWidth:-1},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.index,n=e.onClick,a=e.photo,o=e.margin;return i.a.createElement("div",{style:{margin:o},onClick:function(e){return n(e,{index:t,photo:a})}},i.a.createElement("img",{className:"thumb-image",width:a.width,height:a.height,src:a.thumb_src,alt:a.title,style:{backgroundImage:"url(".concat(a.tiny_src,")"),backgroundSize:"cover"}}))}}]),t}(a.Component),B=n(89),T=n.n(B),A=function(e,t){var n=e.replace(/ /g,"_").substr(5),a=T()(n),i=a.substr(0,1),o=a.substr(0,2);return"https://upload.wikimedia.org/wikipedia/commons/thumb/".concat(i,"/").concat(o,"/").concat(n,"/").concat(t,"-").concat(n)},F=function(e){return fetch("https://commons.wikimedia.org/w/api.php?action=query&list=search&srsearch=haswbstatement:P180=".concat(e,"&srnamespace=6&srlimit=100&format=json&origin=*")).then(function(e){return e.json()}).then(function(e){return{images:e.query.search.map(function(e){return{thumb_src:A(e.title,"300px"),src:(t=e.title,"https://commons.wikimedia.org/wiki/Special:FilePath/".concat(encodeURIComponent(t.substr(5)))),tiny_src:A(e.title,"10px"),url:"https://commons.wikimedia.org/wiki/".concat(e.title.replace(/ /g,"_")),caption:e.title};var t}),totalhits:e.query.searchinfo.totalhits}}).catch(function(e){return console.log(e),null})},J={arrow:{":hover":{opacity:1},backgroundColor:"rgba(255, 255, 255, .8)",fill:"#222",opacity:.6,transition:"opacity .2s"},arrow__direction__left:{marginLeft:10},arrow__direction__right:{marginRight:10},arrow__size__medium:{"@media (min-width: 768px)":{height:70,padding:15},borderRadius:40,height:40,marginTop:-20},container:{background:"rgba(255, 255, 255, .9)"},figure:{boxShadow:"0px 0px 50px rgba(0, 0, 0, .2)"},close:{":hover":{opacity:1},fill:"#222",opacity:.6},footer:{color:"#222",marginLeft:"5px",marginRight:"5px"},footerCaption:{display:"inline-flex",alignItems:"center"},footerCount:{color:"#222",display:"none"}},H=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={qid:null,label:null,images:[],totalhits:0,width:-1,loadingStatus:null,currentImage:0,lightboxIsOpen:!1},n.fetchImages=function(){null!=n.state.qid&&F(n.state.qid).then(function(e){var t=e.images,a=e.totalhits;return n.setState({images:t,totalhits:a,loadingStatus:t.length>0?"loading":"loaded"})})},n.handleImagesLoaded=function(){var e=[];n.state.images.forEach(function(t,a){var i=document.getElementById("img".concat(a));i.naturalWidth>0&&e.push(Object(O.a)({},n.state.images[a],{width:i.naturalWidth,height:i.naturalHeight}))}),n.setState({images:e,loadingStatus:"loaded"})},n.showQID=function(){return n.state.label?"".concat(n.state.qid," (").concat(n.state.label,")"):n.state.qid},n.openLightbox=function(e,t){return n.setState({currentImage:t.index,lightboxIsOpen:!0})},n.closeLightbox=function(){return n.setState({currentImage:0,lightboxIsOpen:!1})},n.gotoPrevious=function(){return n.setState({currentImage:n.state.currentImage-1})},n.gotoNext=function(){return n.setState({currentImage:n.state.currentImage+1})},n.onClickImage=function(e){window.open(n.state.images[n.state.currentImage].url,"_blank")},n.lightboxCaption=function(e){var t=Object(I.renderToString)(i.a.createElement("a",{href:e.url},"a"));return"<span>".concat(e.title).concat(t,"</span>")},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.qid.toUpperCase();(function(e){return fetch("https://www.wikidata.org/w/api.php?action=wbgetentities&props=labels&ids=".concat(e,"&languages=en&format=json&origin=*")).then(function(e){return e.status>=400?null:e.json()}).then(function(t){return null==t.entities?null:t.entities[e].labels.en?t.entities[e].labels.en.value:""}).catch(function(e){return console.log(e),null})})(t).then(function(n){return e.setState({qid:t,label:n})})}},{key:"componentDidUpdate",value:function(e,t){t.qid!==this.state.qid&&this.fetchImages()}},{key:"render",value:function(){var e=this,t=this.state,n=t.qid,a=t.label,o=t.images,r=t.totalhits,c=t.width,l=t.loadingStatus,s=t.currentImage,u=t.lightboxIsOpen;return null==n?i.a.createElement("div",null):i.a.createElement(C.a,null,null==a&&i.a.createElement(M,{icon:Q.a,info:"Wikidata item ".concat(this.showQID()," cannot be found")}),null!=a&&"loading"===l&&i.a.createElement(M,{icon:"spinner",info:"Loading images depicting Wikidata item ".concat(this.showQID())}),null!=a&&"loaded"===l&&o.length>0&&i.a.createElement(L.a,{bounds:!0,onResize:function(t){return e.setState({width:t.bounds.width})}},function(t){var n=t.measureRef;if(c<1)return i.a.createElement("div",{ref:n});var a=1;return c>=320&&(a=2),c>=750&&(a=3),c>=1200&&(a=parseInt(c/300,10)),i.a.createElement("div",{ref:n},i.a.createElement(S.a,null,i.a.createElement("div",{className:"depict-title"},i.a.createElement("span",null,"Depictions of ".concat(e.showQID()," on Wikimedia Commons")),i.a.createElement("span",{className:"depict-hits"},"".concat(r," images found").concat(r>100?", only the first 100 are shown":"")))),i.a.createElement(W.a,{photos:o,ImageComponent:U,columns:a,margin:5,onClick:e.openLightbox}),i.a.createElement(P.a,{images:o,onClose:e.closeLightbox,onClickPrev:e.gotoPrevious,onClickNext:e.gotoNext,onClickImage:e.onClickImage,currentImage:s,isOpen:u,theme:J,spinnerColor:"#aaa",backdropClosesModal:!0}))}),null!=a&&"loaded"===l&&0===o.length&&i.a.createElement(M,{icon:Q.a,info:"Cannot find any depictions of ".concat(this.showQID()," on Wikimedia Commons.")}),a&&"loading"===l&&o.length>0&&i.a.createElement(q.a,{onLoaded:function(){return e.handleImagesLoaded()}},o.map(function(e,t){return i.a.createElement("img",{id:"img".concat(t),className:"tiny-images",key:"img".concat(t),src:e.tiny_src,alt:"",style:{display:"none "}})})))}}]),t}(a.Component),Y=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(C.a,null,i.a.createElement("div",{className:"info"},i.a.createElement("p",null,"This tool is designed for displaying depictions of Wikidata items on Wikimedia Commons. For example, the link"," ",i.a.createElement(h.b,{to:"/Q41994"},"/#/Q41994")," shows all the images on Commons that depict"," ",i.a.createElement("a",{href:"https://www.wikidata.org/wiki/Q41994",target:"_blank",rel:"noopener noreferrer"},"Q41994")," ","(",i.a.createElement("i",null,"Phoenicopterus"),", or flamingo)."),i.a.createElement("p",null,"You may also add"," ",i.a.createElement("span",{className:"source-code"},"mw.loader.load( '//www.wikidata.org/w/index.php?title=User:Stevenliuyi/depicts.js&action=raw&ctype=text/javascript' );")," ","to"," ",i.a.createElement("a",{href:"https://www.wikidata.org/wiki/Special:MyPage/common.js",target:"_blank",rel:"noopener noreferrer"},"your personal common.js file")," ","on Wikidata, so that you can directly link to this tool from the sidebar on item's page.")))}}]),t}(a.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"site"},i.a.createElement("div",{className:"site-content"},i.a.createElement(h.a,null,i.a.createElement("div",null,i.a.createElement(d.a,{path:"/",component:j}),i.a.createElement(d.c,null,i.a.createElement(d.a,{exact:!0,path:"/:qid([qQ]\\d+)",component:H}),i.a.createElement(d.a,{path:"/",component:Y}))))),i.a.createElement("footer",{className:"footer"},"Steven Liu\xa0\xa02019"))}}]),t}(a.Component),K=n(91);n.n(K).a.load({google:{families:["Montserrat:700","san-serif"]}}),r.a.render(i.a.createElement(G,null),document.getElementById("root"))},93:function(e,t,n){e.exports=n(185)},98:function(e,t,n){},99:function(e,t,n){}},[[93,1,2]]]);
//# sourceMappingURL=main.3f0ffa90.chunk.js.map