(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{185:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),o=a(12),r=a.n(o),c=(a(98),a(16)),s=a(17),l=a(19),m=a(18),u=a(20),d=(a(99),a(100),a(28)),p=a(23),h=a(34),g=a.n(h),f=a(47),b=a.n(f),w=a(79),E=a.n(w),k=a(81),y=a.n(k),v=a(82),j=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(g.a,{bg:"light",sticky:"top"},i.a.createElement(g.a.Brand,null,i.a.createElement("span",{className:"app-name"},i.a.createElement(d.b,{to:"/"},"Depicts"))),i.a.createElement(g.a.Collapse,{style:{justifyContent:"flex-end"}},i.a.createElement(b.a,null,i.a.createElement(b.a.Link,{href:"https://github.com/stevenliuyi/commons-depicts"},i.a.createElement(E.a,{placement:"bottom",overlay:i.a.createElement(y.a,{id:"source"},"source code")},i.a.createElement(v.a,{size:18}))))))}}]),t}(n.Component),O=a(92),x=a(83),C=a(33),I=a.n(C),_=a(90),S=a.n(_),N=a(84),q=a.n(N),L=a(85),W=a(86),P=a(49),z=a(87),R=a.n(z),D=a(88),Q=a.n(D),M=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"message"},"spinner"===this.props.icon?i.a.createElement(Q.a,{animation:"border",size:"md",className:"message-icon"}):i.a.createElement(this.props.icon,{size:36,className:"message-icon"}),i.a.createElement("div",null,this.props.info))}}]),t}(n.Component),U=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={titleWidth:-1,imageWidth:-1},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.index,a=e.onClick,n=e.photo,o=e.margin;return i.a.createElement("div",{style:{margin:o},onClick:function(e){return a(e,{index:t,photo:n})}},i.a.createElement("img",{className:"thumb-image",width:n.width,height:n.height,src:n.thumb_src,alt:n.title,style:{backgroundImage:"url(".concat(n.tiny_src,")"),backgroundSize:"cover"}}))}}]),t}(n.Component),B=a(89),T=a.n(B),A=function(e,t){var a=e.replace(/ /g,"_").substr(5),n=T()(a),i=n.substr(0,1),o=n.substr(0,2);return"https://upload.wikimedia.org/wikipedia/commons/thumb/".concat(i,"/").concat(o,"/").concat(a,"/").concat(t,"-").concat(a)},F=function(e){return fetch("https://commons.wikimedia.org/w/api.php?action=query&list=search&srsearch=haswbstatement:P180=".concat(e,"&srnamespace=6&srlimit=100&format=json&origin=*")).then(function(e){return e.json()}).then(function(e){return{images:e.query.search.map(function(e){return{thumb_src:A(e.title,"300px"),src:(t=e.title,"https://commons.wikimedia.org/wiki/Special:FilePath/".concat(encodeURIComponent(t.substr(5)))),tiny_src:A(e.title,"10px"),url:"https://commons.wikimedia.org/wiki/".concat(e.title.replace(/ /g,"_")),caption:e.title};var t}),totalhits:e.query.searchinfo.totalhits}}).catch(function(e){return console.log(e),null})},J={arrow:{":hover":{opacity:1},backgroundColor:"rgba(255, 255, 255, .8)",fill:"#222",opacity:.6,transition:"opacity .2s"},arrow__direction__left:{marginLeft:10},arrow__direction__right:{marginRight:10},arrow__size__medium:{"@media (min-width: 768px)":{height:70,padding:15},borderRadius:40,height:40,marginTop:-20},container:{background:"rgba(255, 255, 255, .9)"},figure:{boxShadow:"0px 0px 50px rgba(0, 0, 0, .2)"},close:{":hover":{opacity:1},fill:"#222",opacity:.6},footer:{color:"#222",marginLeft:"5px",marginRight:"5px"},footerCaption:{display:"inline-flex",alignItems:"center"},footerCount:{color:"#222",display:"none"}},H=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={qid:null,status:!1,images:[],totalhits:0,width:-1,loadingStatus:null,currentImage:0,lightboxIsOpen:!1},a.fetchImages=function(){null!=a.state.qid&&F(a.state.qid).then(function(e){var t=e.images,n=e.totalhits;return a.setState({images:t,totalhits:n,loadingStatus:t.length>0?"loading":"loaded"})})},a.handleImagesLoaded=function(){var e=[];a.state.images.forEach(function(t,n){var i=document.getElementById("img".concat(n));i.naturalWidth>0&&e.push(Object(O.a)({},a.state.images[n],{width:i.naturalWidth,height:i.naturalHeight}))}),a.setState({images:e,loadingStatus:"loaded"})},a.openLightbox=function(e,t){return a.setState({currentImage:t.index,lightboxIsOpen:!0})},a.closeLightbox=function(){return a.setState({currentImage:0,lightboxIsOpen:!1})},a.gotoPrevious=function(){return a.setState({currentImage:a.state.currentImage-1})},a.gotoNext=function(){return a.setState({currentImage:a.state.currentImage+1})},a.onClickImage=function(e){window.open(a.state.images[a.state.currentImage].url,"_blank")},a.lightboxCaption=function(e){var t=Object(x.renderToString)(i.a.createElement("a",{href:e.url},"a"));return"<span>".concat(e.title).concat(t,"</span>")},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.qid.toUpperCase();(function(e){return fetch("https://www.wikidata.org/wiki/Special:EntityData/".concat(e)).then(function(e){return e.ok})})(t).then(function(a){return e.setState({qid:t,status:a})})}},{key:"componentDidUpdate",value:function(e,t){t.qid!==this.state.qid&&this.fetchImages()}},{key:"render",value:function(){var e=this,t=this.state,a=t.qid,n=t.status,o=t.images,r=t.totalhits,c=t.width,s=t.loadingStatus,l=t.currentImage,m=t.lightboxIsOpen;return null==a?i.a.createElement("div",null):i.a.createElement(I.a,null,!n&&i.a.createElement(M,{icon:P.a,info:"Wikidata item ".concat(a," cannot be found")}),n&&"loading"===s&&i.a.createElement(M,{icon:"spinner",info:"Loading images depicting Wikidata item ".concat(a)}),n&&"loaded"===s&&o.length>0&&i.a.createElement(L.a,{bounds:!0,onResize:function(t){return e.setState({width:t.bounds.width})}},function(t){var n=t.measureRef;if(c<1)return i.a.createElement("div",{ref:n});var s=1;return c>=320&&(s=2),c>=750&&(s=3),c>=1200&&(s=parseInt(c/300,10)),i.a.createElement("div",{ref:n},i.a.createElement(S.a,null,i.a.createElement("div",{className:"depict-title"},i.a.createElement("span",null,"Depictions of ".concat(a," on Wikimedia Commons")),i.a.createElement("span",{className:"depict-hits"},"".concat(r," images found").concat(r>100?", only the first 100 are shown":"")))),i.a.createElement(W.a,{photos:o,ImageComponent:U,columns:s,margin:5,onClick:e.openLightbox}),i.a.createElement(R.a,{images:o,onClose:e.closeLightbox,onClickPrev:e.gotoPrevious,onClickNext:e.gotoNext,onClickImage:e.onClickImage,currentImage:l,isOpen:m,theme:J,spinnerColor:"#aaa",backdropClosesModal:!0}))}),n&&"loaded"===s&&0===o.length&&i.a.createElement(M,{icon:P.a,info:"Cannot find any depictions of ".concat(a," on Wikimedia Commons.")}),n&&"loading"===s&&o.length>0&&i.a.createElement(q.a,{onLoaded:function(){return e.handleImagesLoaded()}},o.map(function(e,t){return i.a.createElement("img",{id:"img".concat(t),className:"tiny-images",key:"img".concat(t),src:e.tiny_src,alt:"",style:{display:"none "}})})))}}]),t}(n.Component),Y=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(I.a,null,i.a.createElement("div",{className:"info"},i.a.createElement("p",null,"This tool is designed for displaying depictions of Wikidata items on Wikimedia Commons. For example, the link"," ",i.a.createElement(d.b,{to:"/Q41994"},"/#/Q41994")," shows all the images on Commons that depict"," ",i.a.createElement("a",{href:"https://www.wikidata.org/wiki/Q41994",target:"_blank",rel:"noopener noreferrer"},"Q41994")," ","(",i.a.createElement("i",null,"Phoenicopterus"),", or flamingos)."),i.a.createElement("p",null,"You may also add"," ",i.a.createElement("span",{className:"source-code"},"mw.loader.load( '//www.wikidata.org/w/index.php?title=User:Stevenliuyi/depicts.js&action=raw&ctype=text/javascript' );")," ","to"," ",i.a.createElement("a",{href:"https://www.wikidata.org/wiki/Special:MyPage/common.js",target:"_blank",rel:"noopener noreferrer"},"your personal common.js file")," ","on Wikidata, so that you can directly link to this tool from the sidebar on item's page.")))}}]),t}(n.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"site"},i.a.createElement("div",{className:"site-content"},i.a.createElement(d.a,null,i.a.createElement("div",null,i.a.createElement(p.a,{path:"/",component:j}),i.a.createElement(p.c,null,i.a.createElement(p.a,{exact:!0,path:"/:qid([qQ]\\d+)",component:H}),i.a.createElement(p.a,{path:"/",component:Y}))))),i.a.createElement("footer",{className:"footer"},"Steven Liu\xa0\xa02019"))}}]),t}(n.Component),K=a(91);a.n(K).a.load({google:{families:["Montserrat:700","san-serif"]}}),r.a.render(i.a.createElement(G,null),document.getElementById("root"))},93:function(e,t,a){e.exports=a(185)},98:function(e,t,a){},99:function(e,t,a){}},[[93,1,2]]]);
//# sourceMappingURL=main.12909c86.chunk.js.map