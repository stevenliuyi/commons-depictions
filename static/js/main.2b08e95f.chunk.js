(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{185:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),o=n(12),r=n.n(o),c=(n(98),n(16)),s=n(17),l=n(19),m=n(18),u=n(20),d=(n(99),n(100),n(28)),h=n(23),p=n(34),g=n.n(p),f=n(47),b=n.n(f),E=n(79),k=n.n(E),y=n(81),v=n.n(y),w=n(82),O=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(g.a,{bg:"light",sticky:"top"},i.a.createElement(g.a.Brand,null,i.a.createElement("span",{className:"app-name"},i.a.createElement(d.b,{to:"/"},"Depicts"))),i.a.createElement(g.a.Collapse,{style:{justifyContent:"flex-end"}},i.a.createElement(b.a,null,i.a.createElement(b.a.Link,{href:"https://github.com/stevenliuyi/commons-depicts"},i.a.createElement(k.a,{placement:"bottom",overlay:i.a.createElement(v.a,{id:"source"},"source code")},i.a.createElement(w.a,{size:18}))))))}}]),t}(a.Component),j=n(92),C=n(83),x=n(33),I=n.n(x),_=n(90),S=n.n(_),N=n(84),q=n.n(N),L=n(85),W=n(86),z=n(49),P=n(87),R=n.n(P),D=n(88),Q=n.n(D),B=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"message"},"spinner"===this.props.icon?i.a.createElement(Q.a,{animation:"border",size:"md",className:"message-icon"}):i.a.createElement(this.props.icon,{size:36,className:"message-icon"}),i.a.createElement("div",null,this.props.info))}}]),t}(a.Component),M=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={titleWidth:-1,imageWidth:-1},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.index,n=e.onClick,a=e.photo,o=e.margin;return i.a.createElement("div",{style:{margin:o},onClick:function(e){return n(e,{index:t,photo:a})}},i.a.createElement("img",{className:"thumb-image",width:a.width,height:a.height,src:a.thumb_src,alt:a.title,style:{backgroundImage:"url(".concat(a.tiny_src,")"),backgroundSize:"cover"}}))}}]),t}(a.Component),T=n(89),U=n.n(T),A=function(e,t){var n=e.replace(/ /g,"_").substr(5),a=U()(n),i=a.substr(0,1),o=a.substr(0,2);return"https://upload.wikimedia.org/wikipedia/commons/thumb/".concat(i,"/").concat(o,"/").concat(n,"/").concat(t,"-").concat(n)},F=function(e){return fetch("https://commons.wikimedia.org/w/api.php?action=query&list=search&srsearch=haswbstatement:P180=".concat(e,"&srnamespace=6&srlimit=100&format=json&origin=*")).then(function(e){return e.json()}).then(function(e){return{images:e.query.search.map(function(e){return{thumb_src:A(e.title,"300px"),src:(t=e.title,"https://commons.wikimedia.org/wiki/Special:FilePath/".concat(encodeURIComponent(t.substr(5)))),tiny_src:A(e.title,"10px"),url:"https://commons.wikimedia.org/wiki/".concat(e.title.replace(/ /g,"_")),caption:e.title};var t}),totalhits:e.query.searchinfo.totalhits}}).catch(function(e){return console.log(e),null})},J={arrow:{":hover":{opacity:1},backgroundColor:"rgba(255, 255, 255, .8)",fill:"#222",opacity:.6,transition:"opacity .2s"},arrow__direction__left:{marginLeft:10},arrow__direction__right:{marginRight:10},arrow__size__medium:{"@media (min-width: 768px)":{height:70,padding:15},borderRadius:40,height:40,marginTop:-20},container:{background:"rgba(255, 255, 255, .9)"},figure:{boxShadow:"0px 0px 50px rgba(0, 0, 0, .2)"},close:{":hover":{opacity:1},fill:"#222",opacity:.6},footer:{color:"#222",marginLeft:"5px",marginRight:"5px"},footerCaption:{display:"inline-flex",alignItems:"center"},footerCount:{color:"#222",display:"none"}},H=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={qid:null,status:!1,images:[],totalhits:0,width:-1,loadingStatus:null,currentImage:0,lightboxIsOpen:!1},n.fetchImages=function(){null!=n.state.qid&&F(n.state.qid).then(function(e){var t=e.images,a=e.totalhits;return n.setState({images:t,totalhits:a,loadingStatus:t.length>0?"loading":"loaded"})})},n.handleImagesLoaded=function(){var e=[];n.state.images.forEach(function(t,a){var i=document.getElementById("img".concat(a));i.naturalWidth>0&&e.push(Object(j.a)({},n.state.images[a],{width:i.naturalWidth,height:i.naturalHeight}))}),n.setState({images:e,loadingStatus:"loaded"})},n.openLightbox=function(e,t){return n.setState({currentImage:t.index,lightboxIsOpen:!0})},n.closeLightbox=function(){return n.setState({currentImage:0,lightboxIsOpen:!1})},n.gotoPrevious=function(){return n.setState({currentImage:n.state.currentImage-1})},n.gotoNext=function(){return n.setState({currentImage:n.state.currentImage+1})},n.onClickImage=function(e){window.open(n.state.images[n.state.currentImage].url,"_blank")},n.lightboxCaption=function(e){var t=Object(C.renderToString)(i.a.createElement("a",{href:e.url},"a"));return"<span>".concat(e.title).concat(t,"</span>")},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.qid.toUpperCase();(function(e){return fetch("https://www.wikidata.org/wiki/Special:EntityData/".concat(e)).then(function(e){return e.ok})})(t).then(function(n){return e.setState({qid:t,status:n})})}},{key:"componentDidUpdate",value:function(e,t){t.qid!==this.state.qid&&this.fetchImages()}},{key:"render",value:function(){var e=this,t=this.state,n=t.qid,a=t.status,o=t.images,r=t.totalhits,c=t.width,s=t.loadingStatus,l=t.currentImage,m=t.lightboxIsOpen;return null==n?i.a.createElement("div",null):i.a.createElement(I.a,null,!a&&i.a.createElement(B,{icon:z.a,info:"Wikidata item ".concat(n," cannot be found")}),a&&"loading"===s&&i.a.createElement(B,{icon:"spinner",info:"Loading images depicting Wikidata item ".concat(n)}),a&&"loaded"===s&&o.length>0&&i.a.createElement(L.a,{bounds:!0,onResize:function(t){return e.setState({width:t.bounds.width})}},function(t){var a=t.measureRef;if(c<1)return i.a.createElement("div",{ref:a});var s=1;return c>=320&&(s=2),c>=750&&(s=3),c>=1200&&(s=parseInt(c/300,10)),i.a.createElement("div",{ref:a},i.a.createElement(S.a,null,i.a.createElement("div",{className:"depict-title"},i.a.createElement("span",null,"Depictions of ".concat(n," on Wikimedia Commons")),i.a.createElement("span",{className:"depict-hits"},"".concat(r," images found").concat(r>100?", only the first 100 are shown":"")))),i.a.createElement(W.a,{photos:o,ImageComponent:M,columns:s,margin:5,onClick:e.openLightbox}),i.a.createElement(R.a,{images:o,onClose:e.closeLightbox,onClickPrev:e.gotoPrevious,onClickNext:e.gotoNext,onClickImage:e.onClickImage,currentImage:l,isOpen:m,theme:J,spinnerColor:"#aaa",backdropClosesModal:!0}))}),a&&"loaded"===s&&0===o.length&&i.a.createElement(B,{icon:z.a,info:"Cannot find any depictions of ".concat(n," on Wikimedia Commons.")}),a&&"loading"===s&&o.length>0&&i.a.createElement(q.a,{onLoaded:function(){return e.handleImagesLoaded()}},o.map(function(e,t){return i.a.createElement("img",{id:"img".concat(t),className:"tiny-images",key:"img".concat(t),src:e.tiny_src,alt:"",style:{display:"none "}})})))}}]),t}(a.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(I.a,null,i.a.createElement("div",{className:"info"},"This tool is designed for displaying depictions of Wikidata items on Wikimedia Commons. For example, the link"," ",i.a.createElement(d.b,{to:"/Q41994"},"/Q41994")," shows all the images on Commons that depict"," ",i.a.createElement("a",{href:"https://www.wikidata.org/wiki/Q41994",target:"_blank",rel:"noopener noreferrer"},"Q41994")," ","(",i.a.createElement("i",null,"Phoenicopterus"),", or flamingos)."))}}]),t}(a.Component),K=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"site"},i.a.createElement("div",{className:"site-content"},i.a.createElement(d.a,{basename:"/depicts"},i.a.createElement("div",null,i.a.createElement(h.a,{path:"/",component:O}),i.a.createElement(h.c,null,i.a.createElement(h.a,{exact:!0,path:"/:qid([qQ]\\d+)",component:H}),i.a.createElement(h.a,{path:"/",component:G}))))),i.a.createElement("footer",{className:"footer"},"Steven Liu\xa0\xa02019"))}}]),t}(a.Component),V=n(91);n.n(V).a.load({google:{families:["Montserrat:700","san-serif"]}}),r.a.render(i.a.createElement(K,null),document.getElementById("root"))},93:function(e,t,n){e.exports=n(185)},98:function(e,t,n){},99:function(e,t,n){}},[[93,1,2]]]);
//# sourceMappingURL=main.2b08e95f.chunk.js.map